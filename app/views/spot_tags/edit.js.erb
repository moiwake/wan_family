var tag = document.getElementById("tag-<%= @spot_tag.id %>");

var tagForm = document.getElementsByClassName("tag-form");
if (!tagForm[0]) {
  var tagBars = tag.getElementsByClassName("tag-bar");
  tagBars[0].remove();

  var newTagLink = document.getElementById("new-tag-link");
  newTagLink.remove();

  var editTagBtns = document.getElementsByClassName("edit-tag-btn");
  while (editTagBtns[0]) {
    editTagBtns[0].remove();
  }

  var openMemo = document.getElementsByClassName("open-memo");
  if (openMemo[0]) {
    openMemo[0].remove();
  }
} else {
  tagForm[0].remove();
}

tag.insertAdjacentHTML("beforeend",
  "<%= j(render "spot_tags/shared/tag_form",
    spot_tag: @spot_tag,
    spot_tag_names: @spot_tag_names,
    spot: @spot,
    url: spot_spot_tag_path(@spot, @spot_tag)
  ) %>"
)

var createdTags = document.getElementsByClassName("created-tag");
for (var i = 0; i < createdTags.length; i++) {
  createdTags[i].addEventListener("click", function (e){
    var parent = e.target.parentElement;
    var tagNameForm = document.getElementById("tag-name-form");
    tagNameForm.value = parent.innerText;
  });
}
