var markSpot = document.getElementById("mark-spot");
markSpot.insertAdjacentHTML('beforeend',
  '<%= j(render "spot_tags/shared/tag_index",
    spot_tags: @spot_tags,
    spot: @spot
  )%>'
);

markSpot.insertAdjacentHTML('afterbegin',
  '<%= j(render "spot_tags/shared/tag_spot",
    spot_tags: @spot_tags,
    spot: @spot
  )%>'
);

var tagSpot = document.getElementsByClassName("tag-spot");
tagSpot[1].remove();

var tagOverlay = document.getElementsByClassName("tag-overlay");
if (tagOverlay.length > 1) {
  closeTaglist();
}

var iClose = document.getElementsByClassName("fa-solid fa-xmark")[0];
iClose.addEventListener("click", closeTaglist);

function closeTaglist () {
  tagOverlay[0].remove();
}

var tagMemos = document.getElementsByClassName("expand-tag-btn");
for (var i = 0; i < tagMemos.length; i++) {
  tagMemos[i].addEventListener("click", function(e) {
    var index = [].slice.call(tagMemos).indexOf(e.target);

    if (index == -1) {
      var index = [].slice.call(tagMemos).indexOf(e.target.parentElement);
    }

    var displayMemo = document.getElementsByClassName("display-memo");
    if (displayMemo[index].classList.contains("hidden-memo")) {
      displayMemo[index].classList.remove("hidden-memo");
      displayMemo[index].classList.add("open-memo");
      tagMemos[index].children[0].classList.remove("fa-angles-down");
      tagMemos[index].children[0].classList.add("fa-angles-up");
    } else {
      displayMemo[index].classList.remove("open-memo");
      displayMemo[index].classList.add("hidden-memo");
      tagMemos[index].children[0].classList.remove("fa-angles-up");
      tagMemos[index].children[0].classList.add("fa-angles-down");
    }
  });
}
